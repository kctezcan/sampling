## Here we explain each file:
1. run_reconsamp_hcp.py: this file is a script to run an example from the HCP dataset. It first loads the example slice, does the necessary preprocessing, then runs a deep density prior (DDP) reconstruction, then runs the sampling to obtain the decoder output samples (x ~ p(x|z)), then runs the sampling to obtain the proper samples (x ~ p(x|y,z)).
2. run_reconsamp_usz.py: this file is a script to run an example from the in-house dataset, measured at the University Hospital Zurich (USZ). It follows the same steps as the one above.
3. vaerecon5.py, vaerecon6.py: these are the functions for the DDP reconstruction. The difference is minimal between the two, one has the functionality of bias field correction as well.
4. vaesampling.py: this is the function that runs the decoder output sampling, implementing the l-MALA method, i.e. the MCMC sampling.
5. definevae2.py: this file creates the VAE graph necessary for the DDP reconstruction and loads its trained weights and returns the necessary parts of the VAE for reconstruction.
6. definevae_2d_v1_mri_nocov_fullim_conz_homodyn_varsize_f2.py: this file creates the 2D latent space VAE graph necessary for the l-MALA sampling and loads its trained weights and returns the necessary structures from the VAE for the sampling.
7. Patcher.py: this is a class that aids in creating patches from an image and combining the patches to an image quickly. It is used by the vaereconX.py files as we do the DDP reconstruction patchwise here.
8. /training/cvae_sparsity_check_mri_inpaint_ms_24_joint_half.py: this is a file used for training the patchwise VAE, used to the DDP reconstruction. We provide the file here as is and the user needs to change the directories etc specific for their use. The class that supplies the images is the Dataset.py, which has two main functions, DS.get_test_batch(batch_size) and DS.get_train_batch(batch_size) with an instance of the class DS, which provide a batch of patches extracted from the fully sampled training/test images. This needs to be written for your dataset.
9. /training/definevae_2d_v1_mri_nocov_fullim_conz_homodyn_60ularge_varsize.py: this is the training code used to train the 2D latent space VAE. Again, the file needs to be changed for users needs. The class that supplies the images is the MR_image_data_v3.py, which has a main function, MRi.get_batch(batch_size, test=False) and MRi.get_batch(batch_size, test=True) with an instance of the class MRi, which provide a batch of images from the fully sampled training/test images. This needs to be written for your dataset. Notice that here the size of the image needs to be a multiple of the stride value used, that is, for instance, we use the image size as 252x308 and the str1=14, str2=14, as both 252 and 308 are divisible by 14. Similarly, to have some overlap between the receptive fields, the kernel size needs to be a bit bigger than the stride, e.g. we use here ks1=ks2=19.
